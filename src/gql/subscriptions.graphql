subscription liveProtocol {
    protocol(id: "0x42069") {
        id
        epoch {
            id
            status
            startblock
            endblock
            starttime
        }
        nuggftStakedEth
        nuggftStakedShares
        activeNuggs(orderBy: idnum) {
            id
            idnum
            activeSwap {
                id
                eth
                endingEpoch
            }
        }
        activeNuggItems {
            id
            activeSwap {
                id
                sellingNuggItem {
                    id
                    item {
                        id
                    }
                }
                eth
                endingEpoch
            }
        }
        activeItems {
            id
            activeSwap {
                id
                sellingItem {
                    id
                }
                eth
                endingEpoch
            }
        }
    }
}

subscription liveDotnugg($tokenId: ID!) {
    nugg(id: $tokenId) {
        id
        dotnuggRawCache
    }
}

subscription liveUser($address: ID!) {
    user(id: $address) {
        offers(where: { claimed: false }) {
            id
            eth
            swap {
                id
                nugg {
                    id
                }
                leader {
                    id
                }
                endingEpoch
            }
        }
        loans {
            id
            endingEpoch
            eth
            nugg {
                id
            }
            epoch {
                id
            }
        }
        nuggs(first: 500) {
            id
            activeLoan {
                id
            }
            activeSwap {
                id
            }
            offers(where: { claimed: false }) {
                id
                eth
                swap {
                    id
                    sellingItem {
                        id
                    }
                    sellingNuggItem {
                        id
                        nugg {
                            id
                        }
                    }
                    leader {
                        id
                    }
                    endingEpoch
                }
            }
        }
    }
}

fragment swapdata on Swap {
    id
    endingEpoch
    epoch {
        id
        startblock
        endblock
        status
        starttime
    }
    num
    eth
    ethUsd
    owner {
        id
    }
    leader {
        id
    }
}

fragment itemswapdata on ItemSwap {
    id
    endingEpoch
    epoch {
        id
        startblock
        endblock
        status
        starttime
    }
    num
    eth
    ethUsd
    owner {
        id
    }
    leader {
        id
    }
}

subscription liveItem($tokenId: ID!) {
    item(id: $tokenId) {
        id
        count
        activeSwap {
            ...itemswapdata
        }
        swaps {
            ...itemswapdata
        }
    }
}

subscription liveNugg($tokenId: ID!) {
    nugg(id: $tokenId) {
        id
        user {
            id
        }
        items {
            id
            activeSwap {
                id
            }
            item {
                id
                feature
                position
            }
        }
        activeLoan {
            id
        }
        activeSwap {
            ...swapdata
        }
        swaps {
            ...swapdata
        }
    }
}
