subscription liveProtocol {
    protocol(id: "0x42069") {
        id
        epoch {
            id
            status
            startblock
            endblock
            starttime
        }
        nuggftStakedEth
        nuggftStakedShares
        activeNuggs(orderBy: idnum) {
            id
            idnum
            activeSwap {
                id
                eth
                endingEpoch
            }
        }
        activeNuggItems {
            id
            activeSwap {
                id
                sellingNuggItem {
                    id
                    item {
                        id
                    }
                }
                eth
                endingEpoch
            }
        }
        activeItems {
            id
            activeSwap {
                id
                sellingItem {
                    id
                }
                eth
                endingEpoch
            }
        }
    }
}

subscription liveDotnugg($tokenId: ID!) {
    nugg(id: $tokenId) {
        id
        dotnuggRawCache
    }
}

subscription liveUser($address: ID!) {
    user(id: $address) {
        offers(where: { claimed: false }) {
            id
            eth
            swap {
                id
                nugg {
                    id
                }
                leader {
                    id
                }
                endingEpoch
            }
        }
        loans {
            id
            endingEpoch
            eth
            nugg {
                id
            }
            epoch {
                id
            }
        }
        nuggs(first: 500) {
            id
            activeLoan {
                id
            }
            activeSwap {
                id
            }
            pendingClaim
            lastTransfer
            offers(where: { claimed: false }) {
                id
                eth
                swap {
                    id
                    sellingItem {
                        id
                    }
                    sellingNuggItem {
                        id
                        nugg {
                            id
                        }
                    }
                    leader {
                        id
                    }
                    endingEpoch
                }
            }
        }
    }
}

fragment swapdata on Swap {
    id
    endingEpoch
    epoch {
        id
        startblock
        endblock
        status
        starttime
    }
    num
    eth
    ethUsd
    owner {
        id
    }
    leader {
        id
    }
}

fragment itemswapdata on ItemSwap {
    id
    endingEpoch
    epoch {
        id
        startblock
        endblock
        status
        starttime
    }
    num
    eth
    ethUsd
    owner {
        id
    }
    leader {
        id
    }
}

fragment liveNugg on Nugg {
    id
    user {
        id
    }
    items {
        id
        activeSwap {
            id
        }
        item {
            id
            feature
            position
        }
    }
    pendingClaim
    lastTransfer
    activeLoan {
        id
    }
    activeSwap {
        ...swapdata
    }
    swaps {
        ...swapdata
    }
}

fragment liveItem on Item {
    id
    count
    activeSwap {
        ...itemswapdata
    }
    swaps {
        ...itemswapdata
    }
}

subscription watchLiveItem($tokenId: ID!) {
    item(id: $tokenId) {
        ...liveItem
    }
}

subscription watchLiveNugg($tokenId: ID!) {
    nugg(id: $tokenId) {
        ...liveNugg
    }
}

subscription liveItemOffers($tokenId: String!) {
    itemOffers(where: { swap_starts_with: $tokenId }, orderBy: eth, orderDirection: desc) {
        nugg {
            id
        }
        eth
        txhash
    }
}

subscription liveOffers($tokenId: String!) {
    offers(where: { swap_starts_with: $tokenId }, orderBy: eth, orderDirection: desc) {
        user {
            id
        }
        eth
        txhash
    }
}

subscription betterLiveItemOffers($tokenId: ID!) {
    item(id: $tokenId) {
        activeSwap {
            offers(orderBy: eth, orderDirection: desc) {
                nugg {
                    id
                }
                eth
                txhash
            }
        }
    }
}

subscription betterLiveOffers($tokenId: ID!) {
    nugg(id: $tokenId) {
        activeSwap {
            offers(orderBy: eth, orderDirection: desc) {
                user {
                    id
                }
                eth
                txhash
            }
        }
    }
}
